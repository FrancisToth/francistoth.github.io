<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
       &middot; Francis Toth
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/poole.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
  <link rel="stylesheet" href="/assets/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="Francis Toth" href="/feed.xml">
</head>


  <body>

    <div class="sidebar">
    <div class="container sidebar-sticky">
      <div class="sidebar-about">
        <h1>
          <a href="/">
            Francis Toth
          </a>
        </h1>
        <p class="lead"></p>
      </div>
  
      <nav class="sidebar-nav">
        <a class="sidebar-nav-item" href="/">Home</a>
  
        
  
        
        
          
        
          
            
              <a class="sidebar-nav-item" href="/about/">About</a>
            
          
        
          
            
          
        
          
            
              <a class="sidebar-nav-item" href="/talks/">Talks</a>
            
          
        
          
        
          
        

        <a target="_blank" href="https://ca.linkedin.com/in/francistoth">Linkedin</a>
        </nav>    
        <p>&copy; 2019. All rights reserved.</p>
    </div>
  </div>
  

    <div class="content container">
      <div class="page">
  <h1 class="page-title"></h1>
  <!-- .slide: data-background="#142D38" -->
<h2 id="microservices">Microservices</h2>

<p>Note:</p>
<ul>
  <li>Première présentation en français</li>
  <li>Remercier Techno-Drink de m’accueillir aujourd’hui pour faire cette présentation</li>
  <li>Revenons au sujet principal</li>
  <li>Le terme Microservice est en vogue</li>
  <li>Qu’est-ce qu’un microservice?</li>
  <li>Le sujet est assez vaste, mais s’efforcer de couvrir les grands fondamentaux</li>
  <li>2mn</li>
</ul>

<hr />
<p><img src="images/spectrum.png" alt="Spectrum" title="Spectrum" /></p>

<p>Note:</p>

<ul>
  <li>Rentrons dans le vif du sujet.</li>
  <li>Tout d’abord: ni complètement monolitique ou purement orienté microservice</li>
  <li>raisonner en terme de valeurs absolues</li>
  <li>prendre des décisions en fonction de principes plutôt qu’en fonction de ce qui est bon pour le produit.</li>
  <li>Chaque choix que vous faites vous permettra de vous déplacer dans ce spectre</li>
  <li>Garder juste en tête qu’il n’y a pas de solution parfaite. Tout est affaire de compromis, et de pragmatisme.</li>
</ul>

<hr />
<h2 id="monolithe-caractérisques">Monolithe: Caractérisques</h2>

<ul>
  <li>Couplage fort</li>
  <li>Déploiement unitaire (“Big Bang”)</li>
  <li>Manque d’orthogonalité (Syndrome de la pelote de laine)</li>
  <li>Cycle de développement longs</li>
  <li>Communication synchrone</li>
  <li>Conçu autour de ressources critiques partagées</li>
  <li>…</li>
</ul>

<p>Note:</p>
<ul>
  <li>Un monolithe est caractérisé principalement par le haut degré de couplage qui existe entre les composants qui le constitue.</li>
  <li>Il ne comporte pas forément tous ces aspects, mais ces derniers sont caractéristiques des monolithes.</li>
  <li>Ce degré de couplage peut avoir plusieurs conséquences:
    <ul>
      <li>un mode de éploiment unitaire. qui nécessite le re-déploiement de l’ensemble des composants à chaque fois qu’un changement est introduit. (Composants ne peuvent être déployés indépendament les uns des autres).</li>
      <li>un manque d’orthogonalité: Helicoptere</li>
      <li>des cycles de développement longs.</li>
    </ul>
  </li>
  <li><strong>Distributed Monolith</strong>:</li>
  <li>Le partage de ressources critiques entre différents services</li>
  <li>L’impossibilité de déployer un service sans en déployer d’autres</li>
  <li>Incapacité de prévenir la propagation d’erreurs issues d’un service dane le reste du système dont il fait parti</li>
  <li>…</li>
</ul>

<hr />
<h2 id="scaling">Scaling</h2>
<p><img src="images/monolith_scaling.png" alt="Monolith Scaling" title="A Monolith Scaling" /></p>

<p>Note:</p>
<ul>
  <li>Comme dis plus tôt, les composants d’un monolith ne peuvent pas être déployé indépendament des autres.</li>
  <li>Par concéquent, scaler un monolithe revient à déployer plusieurs instances de ce dernier.</li>
  <li>Chaque instance est indépendante et ne communique pas avec les autres instances du monolithe.</li>
  <li>Afin de garder l’ensemble consistent, les ressources critiques sont partagées comme c’est le cas ici avec la base de données.</li>
</ul>

<hr />
<h2 id="avantages">Avantages</h2>
<ul>
  <li>Simple à maintenir</li>
  <li>Simple à déployer</li>
  <li>Simple à exploiter</li>
  <li>Simple à “scaler”</li>
</ul>

<p>Note:</p>
<ul>
  <li>Ce type d’architecture comporte certains avantages:</li>
  <li>Si le code du monolith est contenu dans un même projet, les refactorings impliquant plusieurs modules sont plus simples</li>
  <li>Il est également plus simple de maintenir le systeme consistent si les instances partagent la même source de données (le résultat d’une écriture faite dans l’une des instances, sera tout de suite disponible pour les autres instances)</li>
  <li>Le déploiement peut être également plus simple (dans le cas d’une seule archive)</li>
  <li>Exploitation plus simple</li>
  <li>Plus facile &amp;agrave scaler</li>
</ul>

<hr />
<h2 id="inconvénients">Inconvénients</h2>

<ul>
  <li>Limité à la capacité d’une machine</li>
  <li>Manque de flexibilité</li>
  <li>Propagation d’erreur</li>
  <li>Changement difficile à intégrer</li>
</ul>

<p>Note:</p>
<ul>
  <li>Components must be scaled as a group.</li>
  <li>Deep coupling leads to inflexibility.</li>
  <li>Cascading Failures</li>
  <li>Development is typically slow (change is difficult, build times long).</li>
</ul>

<hr />

<!-- .slide: data-background="#066FA1" -->
<h2 id="microservices-1">Microservices</h2>

<p>Note:</p>
<ul>
  <li>Passer du monolithe au microservice nécessite d’augmenter le niveau d’isolation entre les composants du système</li>
</ul>

<hr />
<h2 id="service-oriented-architecture-soa">Service Oriented Architecture (SOA)</h2>

<p><img src="images/soa.png" alt="SOA" title="SOA" /></p>

<p>Note:</p>
<ul>
  <li>Une première étape est d’isoler l’état de chaque composant</li>
  <li>L’état de chaque composant est encapsulée (API)</li>
  <li>Services may live in the same process (monolith) or separate (microservices).</li>
</ul>

<hr />
<h2 id="microservices-2">Microservices</h2>

<p><img src="images/microservices.png" alt="Microservices" title="Microservices" /></p>

<p>Note:</p>
<ul>
  <li>Les microservices introduise un degré d’isolement suppérieur</li>
  <li>Sous-Ensemble de l’approche SOA</li>
  <li>Chaque composant est isolé et peut être déployé indépendament et dispose de son propre schéma de donnée</li>
  <li>En cela, les microservices adoptent une approche auto-gérée</li>
</ul>

<hr />

<h2 id="scaling-1">Scaling</h2>
<p><img src="images/microservice_scaling.png" alt="Microservice Scaling" title="Microservices" /></p>

<p>Note:</p>
<ul>
  <li>Each microservice is scaled independently.</li>
  <li>Could be one or more copies of a service per machine.</li>
  <li>Each machine hosts a subset of the entire system.</li>
</ul>

<hr />

<h2 id="organisation">Organisation</h2>

<ul>
  <li>Nécessite des changements organisationnels.</li>
  <li>Les équipes sont plus indépendantes.</li>
  <li>Coordination moins nécessaire entre les équipes.</li>
  <li>Gains de productivité.</li>
  <li>Organisation plus “scalable”.</li>
</ul>

<hr />
<h2 id="avantages-1">Avantages</h2>

<ul>
  <li>Chaque composant peut scaler à la demande et indépendament.</li>
  <li>Confinement des erreurs</li>
  <li>Couplage faible, architecture plus flexible</li>
  <li>Capable d’intégrer différents langages/technologies</li>
  <li>Cycle de déploiement court (possiblement continue)</li>
</ul>

<hr />

<h2 id="inconvénients-1">Inconvénients</h2>

<ul>
  <li>Exploitation possiblement complexe (DevOps)</li>
  <li>Nécessite une strategé de migration d’API</li>
  <li>Peut fortement impacter l’organisation de l’entreprise (Conway’s law)</li>
</ul>

<blockquote>
  <p>organizations design systems that mirror their own communication structure</p>
</blockquote>

<hr />
<!-- .slide: data-background="#066FA1" -->
<h2 id="principes-disolation">Principes d’isolation</h2>
<p>Note:</p>
<ul>
  <li>As we move from Monoliths to Microservices we are introducing more isolation.</li>
  <li>Isolation provides reduced coupling and increased scalability.</li>
  <li>Reactive Microservices are isolated in:
    <ul>
      <li>State</li>
      <li>Space</li>
      <li>Time</li>
      <li>
        <h2 id="failure">Failure</h2>
        <h2 id="état">État</h2>
      </li>
    </ul>
  </li>
</ul>

<p><img src="images/isolation_state.png" alt="State Isolation" title="State Isolation" /></p>

<p>Note:</p>
<ul>
  <li>All access to a Microservice’s state must go through its API.</li>
  <li>No backdoor access via the database.</li>
  <li>
    <h2 id="allows-the-microservice-to-evolve-internally-without-affecting-the-outside">Allows the microservice to evolve internally without affecting the outside.</h2>
    <h2 id="espace">Espace</h2>
    <p><img src="images/isolation_space.png" alt="Space Isolation" title="Space Isolation" /></p>
  </li>
</ul>

<p>Note:</p>
<ul>
  <li>Microservices should not care where other microservices are deployed.</li>
  <li>It should be possible to move a microservice to another machine, possibly in a different data center without issue.</li>
  <li>
    <h2 id="allows-the-microservice-to-be-scaled-updown-to-meet-demand">Allows the microservice to be scaled up/down to meet demand.</h2>
    <h2 id="temps">Temps</h2>
  </li>
</ul>

<p><img src="images/isolation_time.png" alt="Time Isolation" title="Time Isolation" /></p>

<p>Note:</p>
<ul>
  <li>Microservices should not wait for each other. Requests are asynchronous and non-blocking.
    <ul>
      <li>More efficient use of resources. Resources can be freed immediately, rather than waiting for a request to finish.</li>
    </ul>
  </li>
  <li>Between microservices we expect eventual consistency.
    <ul>
      <li>Provides increased scalability. Total consistency requires central coordination which limits scalability 
(more on this later).
—</li>
    </ul>
  </li>
</ul>

<h2 id="erreur">Erreur</h2>

<p><img src="images/isolation_error.png" alt="Failure Isolation" title="Failure Isolation" /></p>

<p>Note:</p>
<ul>
  <li>Reactive Microservices also isolate failure.</li>
  <li>A failure in one Microservice should not cause another to fail.</li>
  <li>Allows the system to remain operational in spite of failure.</li>
</ul>

<hr />
<!-- .slide: data-background="#066FA1" -->
<h2 id="implémentation">Implémentation</h2>

<p>Note:</p>
<ul>
  <li>Un système conçu à partir de microservices nécessite un découpage clair</li>
  <li>Chaque microservice doit donc avoir une responsabilité propre et une API clairement définie.</li>
  <li>Définir ce périmètre peut s’avérer difficile.</li>
  <li>Core problem: What is a microservice? We have to figure out what each service is, how big is it, what responsibilities does it have.</li>
</ul>

<hr />
<h2 id="single-responsibility-principle">Single Responsibility Principle</h2>

<blockquote>
  <p>A class should have only one reason to change.</p>
</blockquote>

<p><strong>Robert C. Martin</strong></p>

<hr />

<h2 id="domain-driven-design-ddd">Domain Driven Design (DDD)</h2>

<ul>
  <li>Ensemble de techniques permettant de décomposer un problème complexe en un ensemble de sous-problèmes plus simples.</li>
  <li><strong>Objectif</strong>: Créer une représentation du problème compréhensible à la fois par les experts métier et les dévelopeurs.</li>
</ul>

<p>Note:</p>
<ul>
  <li>Le DDD est un ensemble de techniques de briser un problème complexe en un ensemble de sous-problèmes plus simples</li>
  <li>Le but est de créer une reprèsentation du problème ou du plutôt du domaine métier compréhensible à la fois par les experts métier et les personnes chargées de leur fournir une solution.</li>
</ul>

<hr />

<h2 id="définitions">Définitions</h2>

<ul>
  <li><strong>Domaine</strong>: Un champ de connaissance</li>
  <li><strong>Experts Métier</strong>: Toute personne impliqué dans le domaine</li>
  <li><strong>Champ lexical (Ubiquitous Language)</strong>: Language utilisé par les experts pour parler du domaine</li>
</ul>

<p>Note:</p>
<ul>
  <li>Dans le contexte du logiciel, definir le domaine revient a definir le metier que l’on cherche a representer.</li>
  <li>Les experts metiers sont les personnes a meme de parler du domaine. Prendre l’exemple du restaurant</li>
  <li>Le champs lexical est le language utilise par les experts pour parler du domaine entre eux.</li>
</ul>

<hr />

<h2 id="champ-lexical">Champ lexical</h2>

<ul>
  <li>La création du modèle nécessite une communication entre les experts et les développeurs</li>
  <li>Une terminologie doit donc être définie par les experts et utilisée lors de l’implémentation du modèle.</li>
  <li><strong>Objectif</strong>: Permettre aux experts et aux développeurs d’avoir une conversation à propos du domaine sans utiliser des termes liés aux logiciel.</li>
</ul>

<p>Note:</p>

<ul>
  <li>Terminology in the <em>Ubiquitous Language</em> comes from the domain experts.</li>
  <li>Words originate in the domain and are used in the software.</li>
  <li>Avoid taking software terms and introducing them into the domain.</li>
  <li>Chaque sous-domaine comporte son propre champ lexical</li>
  <li>Au sein d’un sous-domaine, la définition d’un terme est toujours la même</li>
  <li>Problem space VS Solution Space</li>
</ul>

<hr />

<h2 id="bounded-context">Bounded Context</h2>

<p><img src="images/restaurant-sub-domain.png" alt="Restaurant Sub Domain" title="Restaurant Sub Domain" /></p>

<ul>
  <li><em>Bounded context</em>: Espace tangible au sein duquel un terme comporte toujours la même définition.</li>
</ul>

<hr />
<h2 id="défi">Défi</h2>

<ul>
  <li>Culture DevOps</li>
  <li>Changements organisationels</li>
  <li>Acceptation des lois des systêmes distribués (Amdahl, Gunter, …)</li>
</ul>

<hr />
<!-- .slide: data-background="#066FA1" -->
<h2 id="conclusion">Conclusion</h2>
<hr />

<h2 id="recap">Recap</h2>
<ul>
  <li>Monolith VS Microservices</li>
  <li>Principes d’isolation: État, Espace, Temps, Erreurs</li>
  <li>
    <h2 id="domain-driven-design-champ-lexical-bounded-context">Domain Driven Design: Champ lexical, <em>bounded context</em></h2>
    <h2 id="pour-aller-plus-loin">Pour aller plus loin</h2>
  </li>
  <li>Consistence éventuelle VS Consistence forte</li>
  <li>Communication synchrone VS asynchrone</li>
  <li>CQRS</li>
</ul>

<p>Note:</p>
<ul>
  <li>Allusion a l’example de la foret</li>
  <li>Loi de la physique (le temps qu’une information arrive, elle sera peut etre deja obsolete)</li>
  <li>La consistence forte</li>
  <li>Sync VS Async</li>
  <li>Transaction distribué -&gt; Saga</li>
</ul>

<hr />
<ul>
  <li><strong>Applied Akka Patterns</strong> par Michael Nash et Wade Waldron</li>
  <li><strong>Designing Data Intensive Application</strong> par Martin Kleppman</li>
  <li><strong>Reactive Design Patterns</strong> par Roland Khun, Brian Hanafee et Jamie Allen</li>
  <li><strong>Functional and Reactive Domain Modeling</strong> par Debasish Gosh</li>
  <li><strong>vaughnvernon.com</strong> (DDD)</li>
  <li>
    <h2 id="lightbend-reactive-architecture-cognitiveclass"><a href="https://cognitiveclass.ai/learn/reactive-architecture-foundations">Lightbend Reactive Architecture</a> (Cognitiveclass)</h2>
    <p><img style="background-color: transparent" src="images/yoppworks.logo-corner-dark.png" />
<span style="font-size: 40px">Merci ! Questions ?</span><br />
<span style="font-size: 25px">francis.toth@yoppworks.com</span></p>
  </li>
</ul>

<hr />

<h2 id="strong-consistency">Strong Consistency</h2>

<blockquote>
  <p>An update to a piece of data needs agreement from all nodes before it becomes visible.</p>
</blockquote>

<hr />

<h2 id="eventual-consistency">Eventual Consistency</h2>

<blockquote>
  <p>Eventual consistency guarantees that, in the absence of new updates, all accesses to a specific piece of data
will eventually return the most recent value.</p>
</blockquote>

</div>

    </div>

  </body>
</html>
